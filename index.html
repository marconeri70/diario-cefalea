<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <title>Diario Cefalea</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icons/icon-192.png" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />

  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <header class="app-header">
    <div class="brand">
      <img class="logo" src="./assets/ptv.png" alt="Fondazione PTV" />
      <div class="brand-text">
        <div class="brand-title">Diario Cefalea</div>
        <div class="brand-subtitle">Registro ‚Ä¢ Trigger ‚Ä¢ Grafici ‚Ä¢ Report PDF</div>
      </div>
    </div>

    <div class="header-actions">
      <button id="btnInstall" class="btn btn-ghost" hidden>‚¨áÔ∏è Installa</button>

      <div class="header-field">
        <div class="label">Data</div>
        <input id="globalDate" type="date" class="input" />
      </div>

      <div class="header-field">
        <div class="label">Mese</div>
        <input id="month" type="month" class="input" />
      </div>

      <div class="header-field">
        <div class="label">Tema</div>
        <select id="themeSelect" class="input">
          <option value="auto">Auto</option>
          <option value="dark">Scuro</option>
          <option value="light">Chiaro</option>
        </select>
      </div>
    </div>
  </header>

  <nav class="tabs" aria-label="Navigazione">
    <button class="tab active" data-view="diario" data-accent="blue" type="button">
      <span class="tab-ico">üìù</span><span>Diario</span>
    </button>
    <button class="tab" data-view="statistiche" data-accent="cyan" type="button">
      <span class="tab-ico">üìä</span><span>Statistiche</span>
    </button>
    <button class="tab" data-view="report" data-accent="amber" type="button">
      <span class="tab-ico">üßæ</span><span>Report PDF</span>
    </button>
    <button class="tab" data-view="impostazioni" data-accent="violet" type="button">
      <span class="tab-ico">‚öôÔ∏è</span><span>Impostazioni</span>
    </button>
  </nav>

  <main class="container">
    <!-- =======================
         DIARIO
         ======================= -->
    <section id="view-diario" class="view active">
      <div class="card" id="card-form">
        <div class="section-title">
          <div class="section-title-left">
            <h2>Inserisci attacco</h2>
            <p class="muted">Compila i campi principali e aggiungi trigger / posizione / note.</p>
          </div>
          <div class="pill">Touch-friendly</div>
        </div>

        <form id="attackForm" class="form">
          <div class="grid">
            <div class="field">
              <label class="label" for="date">Data</label>
              <input id="date" class="input" type="date" />
              <div class="hint">Suggerimento: questa data aggiorna automaticamente anche la data globale.</div>
            </div>

            <div class="field">
              <label class="label" for="time">Ora (opzionale)</label>
              <input id="time" class="input" type="time" />
            </div>

            <div class="field">
              <label class="label" for="intensity">Intensit√† (1‚Äì10)</label>
              <input id="intensity" class="input" type="number" min="1" max="10" step="1" placeholder="Es. 7" />
            </div>

            <div class="field">
              <label class="label" for="duration">Durata (ore)</label>
              <input id="duration" class="input" type="number" min="0.5" step="0.5" placeholder="Es. 6" />
            </div>
          </div>

          <div class="field">
            <label class="label" for="meds">Farmaci assunti (selezione multipla)</label>
            <select id="meds" class="input" multiple size="6">
              <option value="Relpax">Relpax</option>
              <option value="Okitask (FANS)">Okitask (FANS)</option>
              <option value="Ibuprofene (FANS)">Ibuprofene (FANS)</option>
              <option value="Naproxene (FANS)">Naproxene (FANS)</option>
              <option value="Paracetamolo">Paracetamolo</option>
              <option value="Altro (FANS)">Altro (FANS)</option>
              <option value="Nessuno">Nessuno</option>
            </select>
            <div class="hint">Tip: su Android puoi tenere premuto e selezionare pi√π opzioni.</div>
          </div>

          <div class="grid">
            <div class="field">
              <label class="label" for="efficacy">Risposta ai farmaci</label>
              <select id="efficacy" class="input">
                <option value="Nessuna">Nessuna</option>
                <option value="Parziale" selected>Parziale</option>
                <option value="Buona">Buona</option>
                <option value="Ottima">Ottima</option>
              </select>
            </div>

            <div class="field">
              <label class="label" for="stress">Stress (0‚Äì10) <span class="badge-mini" id="stressVal">0</span></label>
              <input id="stress" class="input" type="range" min="0" max="10" step="1" value="0" />
              <div class="hint">Valore indicativo (pi√π alto = pi√π stress).</div>
            </div>
          </div>

          <div class="grid">
            <div class="field">
              <label class="label" for="sleepHours">Ore di sonno (opzionale)</label>
              <input id="sleepHours" class="input" type="number" min="0" max="24" step="0.5" placeholder="Es. 5.5" />
            </div>
            <div class="field">
              <label class="label" for="weather">Meteo (opzionale)</label>
              <input id="weather" class="input" type="text" placeholder="Es. pioggia / sbalzo temperatura" />
            </div>
            <div class="field">
              <label class="label" for="foods">Alimenti (opzionale)</label>
              <input id="foods" class="input" type="text" placeholder="Es. cioccolato, vino, salumi..." />
            </div>
          </div>

          <div class="field">
            <label class="label">Trigger (spuntare se presenti)</label>
            <div id="triggerChips" class="chips">
              <label class="chip"><input type="checkbox" value="Stress" /> Stress</label>
              <label class="chip"><input type="checkbox" value="Poco sonno" /> Poco sonno</label>
              <label class="chip"><input type="checkbox" value="Meteo" /> Meteo</label>
              <label class="chip"><input type="checkbox" value="Alimenti" /> Alimenti</label>
              <label class="chip"><input type="checkbox" value="Luci/Schermi" /> Luci/Schermi</label>
              <label class="chip"><input type="checkbox" value="Rumore" /> Rumore</label>
              <label class="chip"><input type="checkbox" value="Fatica" /> Fatica</label>
              <label class="chip"><input type="checkbox" value="Ciclo/Ormoni" /> Ciclo/Ormoni</label>
              <label class="chip"><input type="checkbox" value="Collo/Tensione" /> Collo/Tensione</label>
            </div>
            <div class="hint">Nota: alcuni trigger possono essere dedotti automaticamente (es. stress alto, poco sonno).</div>
          </div>

          <!-- ‚úÖ NUOVO: POSIZIONE DOLORE (clinico, touch) -->
          <div class="field">
            <div class="pain-card">
              <div class="pain-headline">
                <div>
                  <div class="pain-kicker">AGGIUNGI DETTAGLI EPISODIO (OPZIONALE)</div>
                  <div class="pain-title">Posizione del tuo dolore</div>
                  <div class="pain-sub">Tocca una zona sulla testa: verr√† evidenziata.</div>
                </div>

                <div class="pain-actions">
                  <div class="chip-soft" id="painSelectionLabel">Selezione: ‚Äî</div>
                  <button type="button" id="btnClearPain" class="btn btn-ghost">Pulisci</button>
                </div>
              </div>

              <div class="pain-tabs" role="tablist" aria-label="Scegli prospettiva">
                <button type="button" class="pain-tab active" data-persp="front" role="tab" aria-selected="true">Davanti</button>
                <button type="button" class="pain-tab" data-persp="left" role="tab" aria-selected="false">Sinistra</button>
                <button type="button" class="pain-tab" data-persp="right" role="tab" aria-selected="false">Destra</button>
                <button type="button" class="pain-tab" data-persp="back" role="tab" aria-selected="false">Dietro</button>
              </div>

              <div class="pain-stage">
                <!-- FRONT -->
                <div class="pain-figure active" data-figure="front" aria-label="Testa - fronte">
                  <svg class="head-svg" viewBox="0 0 260 300" role="img" aria-label="Selettore dolore fronte">
                    <defs>
                      <radialGradient id="gHead1" cx="30%" cy="20%" r="80%">
                        <stop offset="0%" stop-color="rgba(130,200,255,.95)" />
                        <stop offset="55%" stop-color="rgba(40,120,210,.85)" />
                        <stop offset="100%" stop-color="rgba(10,30,70,.85)" />
                      </radialGradient>
                      <linearGradient id="gGlow" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" stop-color="rgba(79,230,255,.35)" />
                        <stop offset="100%" stop-color="rgba(43,108,255,.10)" />
                      </linearGradient>
                      <filter id="shadowSoft" x="-30%" y="-30%" width="160%" height="160%">
                        <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="rgba(0,0,0,.35)" />
                      </filter>
                    </defs>

                    <g filter="url(#shadowSoft)">
                      <path d="M130 18
                               C75 18 42 62 42 118
                               C42 178 62 242 130 280
                               C198 242 218 178 218 118
                               C218 62 185 18 130 18Z"
                            fill="url(#gHead1)" opacity="0.98"/>
                      <path d="M65 120 C78 92 102 78 130 78 C158 78 182 92 195 120"
                            fill="none" stroke="rgba(255,255,255,.25)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M95 150 C110 142 118 142 130 142 C142 142 150 142 165 150"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M112 200 C120 206 140 206 148 200"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                      <circle cx="58" cy="150" r="18" fill="rgba(255,255,255,.10)" stroke="rgba(255,255,255,.20)"/>
                      <circle cx="202" cy="150" r="18" fill="rgba(255,255,255,.10)" stroke="rgba(255,255,255,.20)"/>
                      <path d="M130 108 C124 130 124 150 130 164 C136 150 136 130 130 108Z"
                            fill="rgba(255,255,255,.12)"/>
                      <path d="M50 70 C78 35 112 26 130 26 C148 26 182 35 210 70"
                            fill="url(#gGlow)" opacity="0.65"/>
                    </g>

                    <!-- Aree cliccabili (overlay) -->
                    <g class="pain-areas">
                      <!-- fronte sx/dx -->
                      <path class="pain-area" data-area="front_forehead_left"
                        d="M130 35 L80 35 C62 55 55 75 55 95 L55 112 C80 98 102 92 130 90 Z"/>
                      <path class="pain-area" data-area="front_forehead_right"
                        d="M130 35 L180 35 C198 55 205 75 205 95 L205 112 C180 98 158 92 130 90 Z"/>

                      <!-- tempia sx/dx -->
                      <path class="pain-area" data-area="front_temple_left"
                        d="M55 112 C70 105 82 102 95 102 C88 120 85 135 85 152 C72 152 62 145 55 135 Z"/>
                      <path class="pain-area" data-area="front_temple_right"
                        d="M205 112 C190 105 178 102 165 102 C172 120 175 135 175 152 C188 152 198 145 205 135 Z"/>

                      <!-- occhio sx/dx -->
                      <path class="pain-area" data-area="front_eye_left"
                        d="M86 140 C98 132 114 132 124 140 C114 150 98 150 86 140 Z"/>
                      <path class="pain-area" data-area="front_eye_right"
                        d="M136 140 C146 132 162 132 174 140 C162 150 146 150 136 140 Z"/>

                      <!-- mandibola sx/dx -->
                      <path class="pain-area" data-area="front_jaw_left"
                        d="M72 186 C86 206 104 224 130 238 L130 260 C98 246 78 222 62 196 Z"/>
                      <path class="pain-area" data-area="front_jaw_right"
                        d="M188 186 C174 206 156 224 130 238 L130 260 C162 246 182 222 198 196 Z"/>
                    </g>
                  </svg>
                </div>

                <!-- LEFT -->
                <div class="pain-figure" data-figure="left" aria-label="Testa - sinistra">
                  <svg class="head-svg" viewBox="0 0 260 300" role="img" aria-label="Selettore dolore sinistra">
                    <defs>
                      <radialGradient id="gHeadL" cx="30%" cy="20%" r="80%">
                        <stop offset="0%" stop-color="rgba(130,200,255,.95)" />
                        <stop offset="55%" stop-color="rgba(40,120,210,.85)" />
                        <stop offset="100%" stop-color="rgba(10,30,70,.85)" />
                      </radialGradient>
                      <filter id="shadowSoftL" x="-30%" y="-30%" width="160%" height="160%">
                        <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="rgba(0,0,0,.35)" />
                      </filter>
                    </defs>

                    <g filter="url(#shadowSoftL)">
                      <path d="M160 28
                               C95 28 65 70 65 126
                               C65 190 98 250 160 278
                               C198 260 214 210 214 150
                               C214 82 198 28 160 28Z"
                            fill="url(#gHeadL)"/>
                      <circle cx="68" cy="160" r="18" fill="rgba(255,255,255,.10)" stroke="rgba(255,255,255,.20)"/>
                      <path d="M150 120 C140 135 138 150 146 168"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M140 200 C150 206 164 206 174 200"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                    </g>

                    <g class="pain-areas">
                      <path class="pain-area" data-area="left_forehead"
                        d="M160 40 C120 40 95 60 85 85 C110 80 132 78 160 80 Z"/>
                      <path class="pain-area" data-area="left_temple"
                        d="M82 110 C100 100 118 96 138 96 C130 118 128 138 132 158 C112 160 96 148 82 130 Z"/>
                      <path class="pain-area" data-area="left_eye"
                        d="M112 140 C124 132 138 132 148 140 C138 150 124 150 112 140 Z"/>
                      <path class="pain-area" data-area="left_jaw"
                        d="M92 188 C108 214 130 235 160 250 C146 262 120 250 98 220 Z"/>
                      <path class="pain-area" data-area="left_neck"
                        d="M150 255 C140 272 130 284 115 292 C135 292 155 288 172 278 Z"/>
                    </g>
                  </svg>
                </div>

                <!-- RIGHT -->
                <div class="pain-figure" data-figure="right" aria-label="Testa - destra">
                  <svg class="head-svg" viewBox="0 0 260 300" role="img" aria-label="Selettore dolore destra">
                    <defs>
                      <radialGradient id="gHeadR" cx="70%" cy="20%" r="80%">
                        <stop offset="0%" stop-color="rgba(130,200,255,.95)" />
                        <stop offset="55%" stop-color="rgba(40,120,210,.85)" />
                        <stop offset="100%" stop-color="rgba(10,30,70,.85)" />
                      </radialGradient>
                      <filter id="shadowSoftR" x="-30%" y="-30%" width="160%" height="160%">
                        <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="rgba(0,0,0,.35)" />
                      </filter>
                    </defs>

                    <g filter="url(#shadowSoftR)">
                      <path d="M100 28
                               C165 28 195 70 195 126
                               C195 190 162 250 100 278
                               C62 260 46 210 46 150
                               C46 82 62 28 100 28Z"
                            fill="url(#gHeadR)"/>
                      <circle cx="192" cy="160" r="18" fill="rgba(255,255,255,.10)" stroke="rgba(255,255,255,.20)"/>
                      <path d="M110 120 C120 135 122 150 114 168"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M120 200 C110 206 96 206 86 200"
                            fill="none" stroke="rgba(255,255,255,.22)" stroke-width="2" stroke-linecap="round"/>
                    </g>

                    <g class="pain-areas">
                      <path class="pain-area" data-area="right_forehead"
                        d="M100 40 C140 40 165 60 175 85 C150 80 128 78 100 80 Z"/>
                      <path class="pain-area" data-area="right_temple"
                        d="M178 110 C160 100 142 96 122 96 C130 118 132 138 128 158 C148 160 164 148 178 130 Z"/>
                      <path class="pain-area" data-area="right_eye"
                        d="M148 140 C136 132 122 132 112 140 C122 150 136 150 148 140 Z"/>
                      <path class="pain-area" data-area="right_jaw"
                        d="M168 188 C152 214 130 235 100 250 C114 262 140 250 162 220 Z"/>
                      <path class="pain-area" data-area="right_neck"
                        d="M110 255 C120 272 130 284 145 292 C125 292 105 288 88 278 Z"/>
                    </g>
                  </svg>
                </div>

                <!-- BACK -->
                <div class="pain-figure" data-figure="back" aria-label="Testa - dietro">
                  <svg class="head-svg" viewBox="0 0 260 300" role="img" aria-label="Selettore dolore dietro">
                    <defs>
                      <radialGradient id="gHeadB" cx="50%" cy="20%" r="80%">
                        <stop offset="0%" stop-color="rgba(130,200,255,.95)" />
                        <stop offset="55%" stop-color="rgba(40,120,210,.85)" />
                        <stop offset="100%" stop-color="rgba(10,30,70,.85)" />
                      </radialGradient>
                      <filter id="shadowSoftB" x="-30%" y="-30%" width="160%" height="160%">
                        <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="rgba(0,0,0,.35)" />
                      </filter>
                    </defs>

                    <g filter="url(#shadowSoftB)">
                      <path d="M130 18
                               C75 18 42 62 42 118
                               C42 178 62 242 130 280
                               C198 242 218 178 218 118
                               C218 62 185 18 130 18Z"
                            fill="url(#gHeadB)"/>
                      <path d="M70 70 C100 40 160 40 190 70"
                            fill="none" stroke="rgba(255,255,255,.18)" stroke-width="3" stroke-linecap="round"/>
                    </g>

                    <g class="pain-areas">
                      <path class="pain-area" data-area="back_occipital_left"
                        d="M130 90 C100 92 80 108 70 130 C88 142 106 150 130 152 Z"/>
                      <path class="pain-area" data-area="back_occipital_right"
                        d="M130 90 C160 92 180 108 190 130 C172 142 154 150 130 152 Z"/>

                      <path class="pain-area" data-area="back_neck_left"
                        d="M90 200 C105 228 118 244 130 252 L130 270 C110 262 95 244 78 214 Z"/>
                      <path class="pain-area" data-area="back_neck_right"
                        d="M170 200 C155 228 142 244 130 252 L130 270 C150 262 165 244 182 214 Z"/>
                    </g>
                  </svg>
                </div>
              </div>

              <div class="hint">Suggerimento: se non vuoi indicare la sede, lascia ‚Äú‚Äî‚Äù.</div>
            </div>
          </div>

          <div class="field">
            <label class="label" for="notes">Note (opzionale)</label>
            <textarea id="notes" class="input textarea" rows="3" placeholder="Es. nausea, fotofobia, riposo a letto..."></textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Salva attacco</button>
            <button id="btnClear" type="button" class="btn btn-ghost">Svuota campi</button>
          </div>
        </form>
      </div>

      <div class="card" id="card-registro">
        <div class="section-title">
          <div class="section-title-left">
            <h2>Registro</h2>
            <p class="muted">Filtra per weekend/feriali e cerca per parole chiave. Il mese √® quello in alto.</p>
          </div>
          <div id="stats" class="stats-inline"></div>
        </div>

        <div class="filters">
          <div class="filter-row">
            <div class="field">
              <label class="label" for="onlyWeekend">Filtro</label>
              <select id="onlyWeekend" class="input">
                <option value="all" selected>Tutti</option>
                <option value="weekend">Solo weekend</option>
                <option value="weekday">Solo feriali</option>
              </select>
            </div>

            <div class="field grow">
              <label class="label" for="q">Cerca</label>
              <input id="q" class="input" type="text" placeholder="Relpax, nausea, Meteo, 2025-11-12..." />
            </div>

            <div class="field actions">
              <label class="label">Azioni</label>
              <div class="btn-row">
                <button id="btnExportMonth" type="button" class="btn btn-ghost">Esporta CSV mese</button>
                <button id="btnExportAll" type="button" class="btn btn-ghost">Esporta CSV tutto</button>
                <button id="btnDeleteAll" type="button" class="btn btn-danger">Cancella tutto</button>
              </div>
            </div>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Data</th>
                <th>Intensit√†</th>
                <th>Durata</th>
                <th>Farmaci</th>
                <th>Risposta</th>
                <th>Trigger</th>
                <th>Posizione</th>
                <th>Note</th>
                <th style="text-align:right">Azioni</th>
              </tr>
            </thead>
            <tbody id="rows"></tbody>
          </table>
        </div>

        <div id="cards" class="cards"></div>
      </div>
    </section>

    <!-- =======================
         STATISTICHE
         ======================= -->
    <section id="view-statistiche" class="view">
      <div class="card">
        <div class="section-title">
          <div class="section-title-left">
            <h2>Statistiche</h2>
            <p class="muted">Grafici mensili (leggibili anche in stampa PDF). Il mese √® quello in alto.</p>
          </div>
          <button id="btnRefreshCharts" class="btn btn-ghost" type="button">Aggiorna grafici</button>
        </div>

        <div class="chart-grid">
          <div class="chart-card">
            <div class="chart-head">
              <h3>Intensit√† (max) giorno per giorno</h3>
              <span class="chip-soft">tutti i giorni visibili</span>
            </div>
            <canvas id="chartIntensity" class="chart-canvas" aria-label="Grafico intensit√†"></canvas>
            <p class="hint">Barre: intensit√† massima del giorno (0 = nessun attacco).</p>
          </div>

          <div class="chart-card">
            <div class="chart-head">
              <h3>Trigger pi√π frequenti</h3>
              <span class="chip-soft">manuali + dedotti</span>
            </div>
            <canvas id="chartTriggers" class="chart-canvas" aria-label="Grafico trigger"></canvas>
            <p class="hint">Conteggio dei trigger selezionati o dedotti (stress alto, poco sonno...).</p>
          </div>

          <div class="chart-card">
            <div class="chart-head">
              <h3>Farmaci pi√π usati</h3>
              <span class="chip-soft">top 10</span>
            </div>
            <canvas id="chartMeds" class="chart-canvas" aria-label="Grafico farmaci"></canvas>
            <p class="hint">Conteggio dei farmaci assunti durante gli attacchi.</p>
          </div>

          <!-- ‚úÖ NUOVO: Posizione dolore -->
          <div class="chart-card">
            <div class="chart-head">
              <h3>Posizione del dolore</h3>
              <span class="chip-soft">top sedi (mese)</span>
            </div>
            <canvas id="chartPain" class="chart-canvas" aria-label="Grafico posizione dolore"></canvas>
            <p class="hint">Conteggio della sede indicata (se non indicata viene conteggiata come ‚ÄúNon indicata‚Äù).</p>
          </div>
        </div>
      </div>
    </section>

    <!-- =======================
         REPORT PDF
         ======================= -->
    <section id="view-report" class="view">
      <div class="card">
        <div class="section-title">
          <div class="section-title-left">
            <h2>Report mensile (PDF / Condivisione)</h2>
            <p class="muted">La data globale e il mese in alto aggiornano automaticamente questa tabella.</p>
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
            <button id="btnPrintReportTop" type="button" class="btn btn-ghost">Stampa</button>
            <button id="btnSharePdfTop" type="button" class="btn btn-primary">Condividi PDF (WhatsApp)</button>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Giorno</th>
                <th>Intensit√†</th>
                <th>Durata</th>
                <th>Farmaci</th>
                <th>Risposta</th>
                <th>Note / Trigger</th>
                <th style="text-align:right">Azioni</th>
              </tr>
            </thead>
            <tbody id="monthlyRows"></tbody>
          </table>
        </div>

        <div class="footer-actions">
          <div class="hint">
            ‚ÄúCondividi PDF‚Äù apre il pannello di condivisione Android: scegli WhatsApp e poi la chat.
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
            <button id="btnPrintReportBottom" type="button" class="btn btn-ghost">Stampa</button>
            <button id="btnSharePdfBottom" type="button" class="btn btn-primary">Condividi PDF (WhatsApp)</button>
          </div>
        </div>
      </div>
    </section>

    <!-- =======================
         IMPOSTAZIONI
         ======================= -->
    <section id="view-impostazioni" class="view">
      <div class="card">
        <div class="section-title">
          <div class="section-title-left">
            <h2>Impostazioni</h2>
            <p class="muted">Nome in intestazione del report e backup/import dati.</p>
          </div>
        </div>

        <div class="grid">
          <div class="field">
            <label class="label" for="patientName">Nome e Cognome (per intestazione Report)</label>
            <input id="patientName" class="input" type="text" placeholder="Es. Mario Rossi" />
            <div class="hint">Il nome verr√† mostrato nel PDF insieme a ‚ÄúDr.ssa Maria Albanese‚Äù.</div>
          </div>
        </div>

        <div class="grid">
          <div class="field">
            <label class="label">Backup</label>
            <button id="btnBackup" class="btn btn-ghost" type="button">Scarica backup JSON</button>
            <div class="hint">Salva tutti i dati in un file JSON.</div>
          </div>

          <div class="field">
            <label class="label" for="fileImport">Import</label>
            <input id="fileImport" class="input" type="file" accept="application/json" />
            <div class="hint">Importa un backup JSON (unisce i dati esistenti).</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
